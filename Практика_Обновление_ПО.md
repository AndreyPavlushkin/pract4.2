# üîÑ –£—á–µ–±–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –ø–∞—Ç—á–∏–Ω–≥–∞ –ü–û (Windows)

## 1. –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å

### üìò –ó–∞—á–µ–º –æ–±–Ω–æ–≤–ª—è—Ç—å –ü–û?
- **–ó–∞–∫—Ä—ã—Ç–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–∞—Ç—á–∏ –¥–ª—è CVE-2023-24932 - Black Lotus Secure Boot)
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** (—Ñ–∏–∫—Å—ã –¥–ª—è BSOD –∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–ª—É–∂–±)
- **–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** (–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è .NET Framework –∏ PowerShell)
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤—ã—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ PowerShell (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å 5.1+ –∏–ª–∏ 7.3+):

$PSVersionTable.PSVersion


*–ï—Å–ª–∏ –≤–µ—Ä—Å–∏—è –Ω–∏–∂–µ 5.1 - –≤–æ–∑–º–æ–∂–Ω—ã —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –∏ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å*

### ü§ñ –†—É—á–Ω–æ–µ vs –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞       | –†—É—á–Ω–æ–µ                  | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ          |
|----------------------|-------------------------|-------------------------|
| –ö–æ–Ω—Ç—Ä–æ–ª—å            | –ü–æ–ª–Ω—ã–π                 | –ß–∞—Å—Ç–∏—á–Ω—ã–π               |
| –†–∏—Å–∫ –∑–∞–±—ã—Ç—å         | –í—ã—Å–æ–∫–∏–π                | –ù–∏–∑–∫–∏–π                  |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ        | –í–æ–∑–º–æ–∂–Ω–æ               | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ              |
| –í—Ä–µ–º—è               | –¢—Ä–µ–±—É–µ—Ç                | –ù–µ —Ç—Ä–µ–±—É–µ—Ç              |
| –î–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤        | –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è       | –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å —Ç–µ—Å—Ç–∞–º–∏ |

---

## 2. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ (Windows)

### ‚úÖ –ó–∞–¥–∞—á–∞ 1: –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

**–ö–æ–º–∞–Ω–¥—ã PowerShell:**

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–¥—É–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏

Install-Module PSWindowsUpdate -Force -Scope CurrentUser
![Alt text](image-24.png)
–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

Get-WindowsUpdate
–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Å –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π

Install-WindowsUpdate -AcceptAll -AutoReboot



**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ PowerShell –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤—ã–≤–æ–¥: `Get-WindowsUpdate | Out-File C:\update_report.txt`

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ü–û

**–ü—Ä–∏–º–µ—Ä –¥–ª—è .NET Framework:**

–ü–æ–∏—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞

Get-WindowsUpdate -Title "NET"
–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—ã–±–æ—Ä–æ—á–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

Install-WindowsUpdate -KBArticleID "KB503XXXX" -AcceptAll



**–†–∏—Å–∫–∏:**
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
- –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∂—É—Ä–Ω–∞–ª–æ–≤: `Get-EventLog -LogName System -Source "WindowsUpdateClient"`

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 4: –°–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**Update-Windows.ps1:**

Write-Host "üîÑ –ó–∞–ø—É—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: $(Get-Date)"
Import-Module PSWindowsUpdate
Get-WindowsUpdate -Install -AcceptAll -AutoReboot -IgnoreUserInput
Write-Host "‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ: $(Get-Date)" | Out-File C:\update.log


**–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ CMD:**

powershell -ExecutionPolicy Bypass -File C:\Update-Windows.ps1



---

### ‚úÖ –ó–∞–¥–∞—á–∞ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

**–ö–æ–º–∞–Ω–¥—ã:**

–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

Get-HotFix | Sort-Object InstalledOn -Descending | Select-Object -First 10
–ê—É–¥–∏—Ç —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
![Alt text](image-25.png)
Get-WmiObject -Class Win32_Product | Where-Object {$_.Version -lt "10.0.0"}

text

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- .NET Framework 4.8+
- PowerShell 5.1/7.3+
- Secure Boot —Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º 2023

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 7: –†–∞–±–æ—Ç–∞ —Å–æ —Å–ª—É–∂–±–∞–º–∏

**–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Windows Defender:**

Restart-Service -Name WinDefend -Force
Get-Service -Name WinDefend | Select-Object Status, StartType


**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∂—É—Ä–Ω–∞–ª–æ–≤:**

Get-EventLog -LogName Application -Source "Windows Defender" -Newest 5


---

### ‚úÖ –ó–∞–¥–∞—á–∞ 8: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

**Log-Update.ps1:**

$LogPath = "C:\Windows\Logs\PSWindowsUpdate.log"
Add-WUServiceManager -ServiceID "7971f918-a847-4430-9279-4a52d1efe18d" -Confirm:$false

Start-Transcript -Path $LogPath -Append
Get-WindowsUpdate -Install -AcceptAll -AutoReboot
Stop-Transcript



**–î–æ–±–∞–≤–∏—Ç—å –≤ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞–Ω–∏–π:**
1. –î–µ–π—Å—Ç–≤–∏–µ: `Start a program`
2. –ü—Ä–æ–≥—Ä–∞–º–º–∞: `powershell.exe`
3. –ê—Ä–≥—É–º–µ–Ω—Ç—ã: `-ExecutionPolicy Bypass -File C:\Log-Update.ps1`

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 9: –ù–∞–ø–æ–º–∏–Ω–∞–ª–∫–∞ —á–µ—Ä–µ–∑ PowerShell

**Notify-Updates.ps1:**

$Updates = Get-WindowsUpdate
if ($Updates.Count -gt 0) {
$Body = "–î–æ—Å—Ç—É–ø–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: $($Updates.Count)`n"
$Body += $Updates | Format-Table -AutoSize | Out-String

text
Send-MailMessage -To "admin@domain.com" -From "updates@domain.com" `
    -Subject "–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ" -Body $Body -SmtpServer "smtp.domain.com"

}


**–î–æ–±–∞–≤–∏—Ç—å –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫:**

schtasks /create /tn "CheckUpdates" /tr "powershell -File C:\Notify-Updates.ps1" /sc daily /st 09:00


---

## 3. –í—ã–≤–æ–¥—ã

### üèÜ –ü–æ–ª–µ–∑–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- **PSWindowsUpdate** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ PowerShell
- **Windows Admin Center** –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **WSUS** –¥–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ä–µ–¥

### üß† –ß—Ç–æ –Ω–æ–≤–æ–≥–æ
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ `Invoke-WUJob` –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
- –†–∞–±–æ—Ç–∞ —Å –∂—É—Ä–Ω–∞–ª–∞–º–∏ —á–µ—Ä–µ–∑ `Get-EventLog`
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–æ—á—Ç–æ–≤—ã–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏

### üõ°Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

–î–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º:

Install-WindowsUpdate -TestMode -AcceptAll
–°–æ–∑–¥–∞—Ç—å —Ç–æ—á–∫—É –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º:

Checkpoint-Computer -Description "Pre-Update" -RestorePointType MODIFY_SETTINGS



---

## –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–¥—É–ª—è (–ó–∞–¥–∞—á–∞ 1)**  

Set-ExecutionPolicy RemoteSigned -Scope Process -Force
Install-Module PSWindowsUpdate -AllowClobber -Force



2. **–°–∫—Ä–∏–ø—Ç-–º–æ–Ω–∏—Ç–æ—Ä (–ó–∞–¥–∞—á–∞ 4)**  
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —á–µ—Ä–µ–∑ Notepad:  

notepad C:\Update-Windows.ps1


–í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ –∑–∞–¥–∞—á–∏ 4, —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ UTF-8

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π (–ó–∞–¥–∞—á–∞ 5)**  
–î–ª—è –ø–æ–∏—Å–∫–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:  

Get-WindowsUpdate -Severity Critical



4. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (–ó–∞–¥–∞—á–∞ 9)**  
–î–ª—è –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫:  

$Trigger = New-JobTrigger -Weekly -At "3:00 AM" -DaysOfWeek Sunday
Register-ScheduledJob -Name AutoUpdate -FilePath C:\Update-Windows.ps1 -Trigger $Trigger



**–í–∞–∂–Ω–æ!** –î–ª—è –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–æ–ª–∏—Ç–∏–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:  

powershell Set-ExecutionPolicy RemoteSigned -Scope LocalMachine



## –†–µ—à–µ–Ω–∏–µ —Ç–∏–ø–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫

1. **–û—à–∏–±–∫–∞ "Value does not fall within the expected range"**  
   –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–±—Ä–æ—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

Reset-WUComponents -Verbose



2. **–ü—Ä–æ–±–ª–µ–º—ã —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –º–æ–¥—É–ª—è**  
–û–±–Ω–æ–≤–∏—Ç–µ NuGet –ø—Ä–æ–≤–∞–π–¥–µ—Ä:

Install-PackageProvider NuGet -Force



3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è**  
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ª—É–∂–±—ã:

sc query wuauserv
net start bits



4. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**  
–£–¥–∞–ª–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:

Remove-WindowsUpdate -KBArticleID "KBXXXXXXX" -Confirm:$false



---

**–ü—Ä–∏–º–µ—Ä –æ—Ç—á—ë—Ç–∞:**  

Get-WindowsUpdate -Last 10 | Format-Table Title, KB, IsDownloaded, IsInstalled


undefined